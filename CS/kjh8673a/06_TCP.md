**TCP**

<br>

### 시퀀스 넘버

RDT에서 피드백(ACK, NAK) 자체에 문제가 있을 경우 제대로 받았는지 알 수 없다.

이럴 경우 sender가 retransmission을 한다. 다시 전송된 정보가 처음으로 전송된 것인지 다시 전송된 것인지를 구분하기 위해 시퀀스 넘버를 이용한다.

시퀀스 넘버가 무한정 늘어나면 메타데이터일 뿐인 숫자가 무한정 공간을 차지하므로 비효율적이다. 따라서, 재전송인지 새로운 패킷인지만 알게 해주는 최소의 시퀀스 넘버만 사용한다. 0, 1의 단 1비트만 사용하여 판단 할 수 있다.

### NAK-free

NAK 대신에 무조건 ACK를 보내면서 시퀀스 넘버를 담아서 보낸다. 이때 시퀀스 넘버는 receiver가 받았던 마지막 시퀀스 넘버를 그대로 담는다.

### RDT 3.0

에러도 존재하면서 loss도 존재할 경우, 패킷 유실을 판단하기 위해서는 일종의 타이머가 필요하다. 시간 제한이 다 될 때까지 응답받지 못하면 유실된 것으로 판단하고 재전송한다.

<br>

## TCP

- point to point: 한 점(sender)과 한 점(receiver)를 연결한다.

- reliable, in-order: 유실되지않고 순서대로 보내진다.

- pipelined: 한꺼번에 많은 양의 데이터가 전송된다.

### TCP 세그먼트의 구조

- port

- sequence number: 세그먼트 데이터의 제일 앞에있는 바이트 번호가 시퀀스 넘버가 된다.

- acknowledgement number(ACK): ACK가 10이라면 9번까지는 다 받았고, 10번을 기다리고있다는 의미.

- receive window

- checksum

### RTT(Round Trip Time)

매번 보낼 때마다 시간(큐잉딜레이때문에 매번 달라진다.)을 측정하여 측정된 시간들을 일련의 계산과정을 거쳐 일정한 RTT값을 구한다. 구해진 RTT값을 이용해 타이머 시간을 설정한다.

### TCP sender의 동작

세그먼트를 만들어서 시퀀스 넘버를 담는다. 타이머가 설정되어있지 않다면 타이머를 설정하고 전송한다. 피드백을 받기 전에 타이머가 끝난다면 해당 세그먼트를 재전송한다.

ACK가 제때 도착했다면 ACK의 시퀀스 넘버를 통해 어디까지 전송이 됐는지 판단하여 새로운 타이머를 재설정한다.