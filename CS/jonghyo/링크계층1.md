# 링크 계층1

- 내가 패킷을 만들어서 보낼 때 나와 연결된 다른 사람도 패킷을 만들어 보낼 때 충돌이 발생할 수 있는데 그 때 링크 계층의 전송단위인 프레임에서 충돌에 대한 것을 탐지하고 충돌했을 때 어떻게 관리할지를 결정해줌.
- source 에서 destination 까지 가는 것을 말하는 것이 아닌 단지 source에서 다음 홉까지 어떻게 갈거에 대한 지에 관한 것.

### 링크 계층은 어디에 구현되어 있는가?

- 보통 인터페이스 카드, 랜선 꼽는 카드에 구현이 되어 있음.

### Adaptors communicating

- 네트워크 계층에서 만들어지는 패킷이 카드, USB등에 전달되게 되면 **프레임**이라는 링크 전송단위에 패키징되어 전송되게 된다.

### Multiple access links, protocols

- 링크 계층 내에서 예를 들어 내가 프레임을 다음 라우터 홉으로 전달하려고 한다면 물리계층에선 그게 전자기파로 되어 나와 같은 Link에 있는 애들에게 Broadcasting 됩니다. Broadcasting이 되니 나 말고 다른 사람도 프레임을 전달하려고 한다면 전자기파가 합성이 되어 쓸 수가 없게 됨.

**이상적인 multiple access protocol**

1. 오로지 한개의 노드에만 전송할 데이터가 있어 Rbps를 다 사용할 수 있는 것.
2. 만약 N명의 노드에서 전송할 데이터가 있다면 R/N bps 로 사용되어야 한다.
3. 분산적으로 작동해야 한다.(서버에서 누가 작동할지 결정해 주는 것이 아니라 각자 알아서 잘 보내야함.)
4. 단순해야 한다.

### MAC protocols

- 크게 3가지 종류로 구분된다
- **channel partitioning**
    - TDMA(time divistion multiple access)
        - 정해진 시간이 있다면 그 시간을 나누고 그 시간에 대해 유저에게 배정해준다. 각 노드들은 배정받은 시간에만 이야기 할 수 있다. ⇒ 충돌은 안나지만 사람이 많지않으면 비효율적이 됌.
    - FDMA(frequency division multiple access)
        - 시간과 달리 주파수 별로 나눠 놓는 것. 이것도 안쓰이는 곳은 낭비가 있음.
- **random access**
    - 내가 전송할 데이터가 있으면 정해진 것 없이 랜덤한 시간에 전송하는 것.
    - 정해진 시간에 말하는게 아니라서 충돌이 발생할 가능성이 있다. ⇒ 어떻게 충돌을 감지하고 해결할 것인지가 핵심
    - CSMA(carrier sense multiple access)
        - 우선 감지하고 그 다음에 받아들일지 아닐지 결정하는 것.
        - 누가 보내고 있는지 체크하고 조용하다면 OK.
        - ex) t0시간에 a라는 친구가 carrier sense를 했을 때 조용해서 프레임을 전송했는데 t1에 b라는 친구가 전송하고 싶어 탐지했더니 t0에 a가 보낸 프레임이 아직 도착하지 않아 조용함. 따라서 t1에 b도 보내게 된다면 충돌이 발생하게 된다. ⇒ 가장 근본적인 원인은 propagation delay. ⇒ 빛의 속도가 0에 수렴한다면 충돌이 발생하지 않음. 즉 보내자마자 받아야 함.
    - CSMA/CD(collision detection)
        - 충돌이 발생했을때 최대한 빨리 그 충돌을 감지해 전송을 멈추기 위해 사용.
        - 충돌이 발생하면 프레임 전체를 전송하는 것이 아니라 바로 중단.
        - 그 후 언제 재전송 해야하는지? ⇒ 예를 들어 0~2ms 사이내에 랜덤한 시간 내에 전송하는데 그때에도 carrier sense를 함. 만약 감지가 된다면 보내지 않고 0~4ms로 시간이 늘어남. 끝의 시간은 2의 지수승으로 증가하게 됌.
- **taking turns**
    - polling
        - 하나의 마스터 노드가 존재하고 연결된 노드들에게 보낼 데이터가 있는지 물어보고 있다면 전송할 순서를 마스터 노드가 결정해줌.
        - central node가 존재하기 때문에 바람직 한 것은 아니다. central node가 동작하지 않는다면 다른 노드들도 동작하지 않기 때문이다.
    - token passing
        - control token이 돌아가서 토큰을 가지고 있는 노드만 전송이 가능하다.
        - 토큰을 받았는데 보낼 데이터가 없다면 토큰을 넘기는 식으로.
        - 누군가 토큰을 잃어버린다면 아무도 데이터를 보낼수 없다는 단점이 존재한다.